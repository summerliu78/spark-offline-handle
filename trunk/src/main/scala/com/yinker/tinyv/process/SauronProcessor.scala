package com.yinker.tinyv.process

import com.alibaba.fastjson.{JSON, JSONObject}
import com.yinker.tinyv.utils.{InkConfig, MySqlUtils}
import org.apache.ibatis.ognl.Ognl
import org.apache.spark.rdd.RDD
import org.apache.spark.sql.{Dataset, Row, SparkSession}

/**
  * Created by Reynold on 17-9-6.
  */
object SauronProcessor {

  /**1
    * 118->详单爬取成功时间,注意要区分微博和平台的,需要union微博的
    * fetchDetailSuccesTime数据都在MySQL中
    *
    * @param spark SparkSession
    */
  def fetchDetailSuccesTime(spark: SparkSession): Dataset[Row] = {
    import spark.implicits._
    MySqlUtils.loadMySQL(InkConfig.MYSQL_LOGIC_URL_PT, "USER_CARRIER",
      spark, InkConfig.MYSQL_LOGIC_PROPERTIES_PT).createOrReplaceTempView("user_carrier_pt")
    MySqlUtils.loadMySQL(InkConfig.MYSQL_LOGIC_URL_WB, "USER_CARRIER",
      spark, InkConfig.MYSQL_LOGIC_PROPERTIES_WB).createOrReplaceTempView("user_carrier_wb")
    val fetchDetailPt = spark.sql(
      """
        |select USER_ID,max(TASK_ID) TASK_ID,CHANNEL,max(CREATE_TIME) CREATETIME  from user_carrier_pt
        |where CRAW_STATUS = '012004002' group by USER_ID,CHANNEL
      """.stripMargin)
      .join(MySqlUtils.loadMySQL(InkConfig.MYSQL_LOGIC_URL_PT, "USER_CALL_TASK", spark, InkConfig.MYSQL_LOGIC_PROPERTIES_PT)
        .select("TASK_ID", "CREATE_TIME"),
        Seq("TASK_ID"))
      .select("USER_ID", "CHANNEL", "CREATE_TIME")
    val fetchDetailWb = spark.sql(
      """
        |select USER_ID,max(TASK_ID) TASK_ID,max('weibo') as CHANNEL,max(ID) id from user_carrier_wb
        |where CRAW_STATUS = '012004002' group by USER_ID
      """.stripMargin)
      .join(MySqlUtils.loadMySQL(InkConfig.MYSQL_LOGIC_URL_WB, "USER_CALL_TASK", spark, InkConfig.MYSQL_LOGIC_PROPERTIES_WB)
        .select("TASK_ID", "CREATE_TIME"),
        Seq("TASK_ID"))
      .selectExpr("USER_ID", "CHANNEL", "CREATE_TIME")

    val res=fetchDetailPt.union(fetchDetailWb)
    println("fetchDetailSuccesTime..........")
    res.show()
    res

  }

  /**
    * 2
    * @param spark
    * @return
    */
  def union117(spark: SparkSession): RDD[(String,String)] = {
    val sql =
      s"""
         |select user_id,ds ,phone_reg_time from edw_tinyv.e_user_integ_info_d where dt = date_add(current_date(),-1) and
         |phone_reg_time is not null
       """.stripMargin
    spark.sql(sql).createOrReplaceTempView("usephone")
    fetchDetailSuccesTime(spark).createOrReplaceTempView("fetch")
    val resultSQL=
      """
        |select a.USER_ID,a.CHANNEL, datediff(a.CREATE_TIME,b.phone_reg_time) days from fetch a join usephone b on a.USER_ID=b.user_id and b.ds=a.CHANNEL
      """.stripMargin
    val resDF=spark.sql(resultSQL)
    println("union117")
    resDF.printSchema()
    resDF.show()
      resDF.rdd.map{row=>
      val userId=row.getAs[Long]("USER_ID")
      val ds=row.getAs[String]("CHANNEL")
      val daysdiff=row.getAs[Int]("days")+""
      (userId+"_"+ds,daysdiff)
    }
  }

  /**3
    * 数据库表注意要区分微博和平台的,需要union微博的
    * emerContactCount数据都在MySQL中
    *
    * @param  spark SparkSession
    */
  def emerContactCount(spark: SparkSession): RDD[(String, Long)] = {
    import spark.implicits._

    val userUrgentDS = MySqlUtils.loadMySQL(InkConfig.MYSQL_LOGIC_URL_PT, "USER_URGENT", spark, InkConfig.MYSQL_LOGIC_PROPERTIES_PT)
      .where("DEL_FLAG=0").select("USER_ID", "CHANNEL", "MOBILE")
      .union(MySqlUtils.loadMySQL(InkConfig.MYSQL_LOGIC_URL_WB, "USER_URGENT", spark, InkConfig.MYSQL_LOGIC_PROPERTIES_WB)
        .where("DEL_FLAG=0 and MOBILE!=''").selectExpr("USER_ID", "'weibo' as CHANNEL", "MOBILE"))
    userUrgentDS.printSchema()
    userUrgentDS.show()
    userUrgentDS.createOrReplaceTempView("USER_UNION")
    val sql=
      s"""
         |select mobile,count(1) mobilenum from USER_UNION group by mobile
       """.stripMargin
    spark.sql(sql).join(userUrgentDS,Seq("mobile")).selectExpr("USER_ID","CHANNEL","mobilenum").map{row=>
      val userId = row.getAs[Long]("USER_ID").toString
      val channel = row.getAs[String]("CHANNEL")
      val mobileNum = row.getAs[Long]("mobilenum")
      (userId + "_" + channel, mobileNum)
    }.rdd.combineByKey((Long) => Long, (a: Long, b: Long) => a + b, (a: Long, b: Long) => a + b)
    /*userUrgentDS.map(x => {

        val userId = x.getAs[Long](0).toString
        val channel = x.getAs[String](1)
        val mobile = x.getAs[String](2)
        val mobileNum= userUrgentDS.where(s"MOBILE='$mobile'").count()
        (userId + "_" + channel, mobileNum)

    }).rdd.combineByKey((Long) => Long, (a: Long, b: Long) => a + b, (a: Long, b: Long) => a + b)*/
  }

  /**4
    * 计算贷后帮索伦的两个字段
    * @param spark :SparkSession
    * @return 返回值为（USER_ID,CHANNEL,NEAR1MONTHSEARCH,HISTORYSEARCH）构成的RDD
    */
  def compSauronDF(spark: SparkSession): RDD[(String, (String, String))] = {
    import spark.implicits._
    MySqlUtils.loadMySQL(InkConfig.MYSQL_LOGIC_URL_PT, "THIRD_CREDIT_QUERY_ORDER", spark, InkConfig.MYSQL_LOGIC_PROPERTIES_PT)
      .where("QUERY_SOURCE='sauron'")
      .selectExpr("ORDER_NO as RISK_ID", "QUERY_RESULT")
      .join(MySqlUtils.loadMySQL(InkConfig.MYSQL_LOGIC_URL_PT, "CREDIT_RISK", spark, InkConfig.MYSQL_LOGIC_PROPERTIES_PT)
        .select("USER_ID", "CHANNEL", "RISK_ID"),
        Seq("RISK_ID")).select("USER_ID", "CHANNEL", "QUERY_RESULT")
      .union(
        MySqlUtils.loadMySQL(InkConfig.MYSQL_LOGIC_URL_WB, "THIRD_CREDIT_QUERY_ORDER", spark, InkConfig.MYSQL_LOGIC_PROPERTIES_WB)
          .where("QUERY_SOURCE='sauron'")
          .selectExpr("ORDER_NO as RISK_ID", "QUERY_RESULT")
          .join(MySqlUtils.loadMySQL(InkConfig.MYSQL_LOGIC_URL_WB, "CREDIT_RISK", spark, InkConfig.MYSQL_LOGIC_PROPERTIES_WB)
            .selectExpr("USER_ID", "'weibo' as CHANNEL", "RISK_ID"),
            Seq("RISK_ID")).select("USER_ID", "CHANNEL", "QUERY_RESULT"))
      .map(addOgnl("history_search", "CollectionData", _)).rdd
  }

  /**5
    * 计算同盾借款｜异常借款_3个月内身份证关联多个申请信息 (分不同的数据源,数据格式也不一样,后面要做兼容)
    *
    * //@param hiveContext hiveContext
    *
    * @return 返回值为（USER_ID,CHANNEL,near3MonthApplyHit）构成的RDD
    */
  def compTDloan(spark:SparkSession): RDD[(String, (String, String))] = {
    import spark.implicits._
    val riskInfo = MySqlUtils.loadMySQL(InkConfig.MYSQL_LOGIC_URL_PT, "CREDIT_RISK", spark, InkConfig.MYSQL_LOGIC_PROPERTIES_PT)
      .select("USER_ID", "CHANNEL", "RISK_ID")
        .union(MySqlUtils.loadMySQL(InkConfig.MYSQL_LOGIC_URL_WB, "CREDIT_RISK", spark, InkConfig.MYSQL_LOGIC_PROPERTIES_WB)
          .selectExpr("USER_ID", "'weibo' as CHANNEL", "RISK_ID"))

    val hiveTdInfo = spark.sql(
      """
        |select get_json_object(jsondata,'$.seqId') as RISK_ID,get_json_object(jsondata,'$.rawData') as rawData,ds as CHANNEL from
        |ods_tinyv_outer.o_fuse_td_detail_v32_mongo

      """.stripMargin)

    val res=riskInfo.join(hiveTdInfo, Seq("RISK_ID","CHANNEL")).select("USER_ID", "CHANNEL", "rawData")
      res.show()
      res.map(addOgnl("0000431", "tdFraudDetail", _)).rdd
  }

  /**6
    * 通过ognl表达式求near1MonthSearch/historySearch/near3MonthApplyHit的值
    *
    * @param queryRow 每一行Row(USER_ID,CHANNEL,QUERY_RESULT)
    */
  def addOgnl(containStr: String, ognlParseName: String, queryRow: Row): (String, (String, String)) = {
    var near1MonthSearch = "-1"
    var historySearch = "-1"
    var near3MonthApplyHit = "-1"
    val userId = queryRow.getAs[Long]("USER_ID")
    val channel = queryRow.getAs[String]("CHANNEL")
    val query_result = queryRow.getAs[String](2)
    val sauronOgnlJson = wrapJson(ognlParseName, query_result)
    val o = JSON.parseObject(sauronOgnlJson)
    ognlParseName match {
      case "CollectionData" =>
        if (o.toString.contains(containStr)) {
          near1MonthSearch = Ognl.getValue(InkConfig.NEAR1MONTHSEARCH, o).toString
          historySearch = Ognl.getValue(InkConfig.HISTORYSEARCH, o).toString
        }
        (userId + "_" + channel, (near1MonthSearch, historySearch))
      case "tdFraudDetail" =>
        if (o.toString.contains(containStr)) {
          println("包含rule_id..")
          near3MonthApplyHit = Ognl.getValue(InkConfig.NEAR3MONTHPAALYHIT, o).toString
        }
        (userId + "_" + channel, (near3MonthApplyHit, ""))
    }

  }

  /**7
    * 在这里包装json,使之满足符合ognl规则的格式
    *
    * @param ognlParseName ognlParseName
    * @param rawField      rawField
    * @return str
    */
  def wrapJson(ognlParseName: String, rawField: String): String = {
    println("执行wrapJson.....")
    if(rawField!=null&&rawField.contains("reason_code")){
      println("rawField是标准json...")
      val preJson: JSONObject = JSON.parseObject(rawField)
      preJson.put("scdataCode", 1)
//      println(s"prejson=$preJson")
      if (ognlParseName == "tdFraudDetail") {
        s"""{$ognlParseName:${preJson.toString.replace("2624882", "0000431").replace("3598528", "0000431").replace("3599088", "0000431")}}""".stripMargin
      } else {
        s"""{$ognlParseName:${preJson.toString}}""".stripMargin
      }
    }else s"""{$ognlParseName:"-1"}""".stripMargin

  }

  /*def main(args: Array[String]): Unit = {
    val query_result=
      """
      {"reason_code":"200","reason_desc":"获取成功","success":"true","rules":[{"conditions":[{"dim_type":"id_number","dim_value":"142223199604136144","hits":[{"value":"142223199604136144","evidence_time":"{\"$numberlong\":\"1507268917000\"}","risk_level_display_name":"中","fraud_type_display_name":"信用异常"},{"value":"142223199604136144","evidence_time":"{\"$numberlong\":\"1507461180000\"}","risk_level_display_name":"中","fraud_type_display_name":"异常借款"}],"type":"grey_list","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":null,"list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598482","score":"5"},{"conditions":[{"dim_type":"account_mobile","dim_value":"15234193973","hits":[{"value":"15234193973","evidence_time":"{\"$numberlong\":\"1507268917000\"}","risk_level_display_name":"中","fraud_type_display_name":"信用异常"},{"value":"15234193973","evidence_time":"{\"$numberlong\":\"1507461180000\"}","risk_level_display_name":"中","fraud_type_display_name":"异常借款"}],"type":"grey_list","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":null,"list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598328","score":"5"},{"conditions":[{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"2","list":["15234193973","171※※※※3906"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"account_mobile","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"2","list":["山西省太※※※※※※※※※※※※※※※楼2单元","西铭九※※※※※※※2单元"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"home_address","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"2","list":["148※※※※988@qq.com","152※※※※※973@qq.com"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"account_email","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598528","score":"6"},{"conditions":[{"dim_type":null,"dim_value":null,"hits":null,"type":"match_address","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":null,"list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":"mobile_address","address_a_value":"太原市","address_b":"true_ip_address","address_b_value":"吕梁市","proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598548","score":"5"},{"conditions":[{"dim_type":null,"dim_value":null,"hits":[{"count":"4","industry_display_name":"一般消费分期平台"},{"count":"1","industry_display_name":"互联网金融门户"},{"count":"2","industry_display_name":"小额贷款公司"},{"count":"8","industry_display_name":"P2P网贷"}],"type":"association_partner","event_type":null,"hits_for_dim":[{"count":"4","industry_display_name":"一般消费分期平台","dim_type":"account_mobile"},{"count":"1","industry_display_name":"互联网金融门户","dim_type":"account_mobile"},{"count":"2","industry_display_name":"小额贷款公司","dim_type":"account_mobile"},{"count":"8","industry_display_name":"P2P网贷","dim_type":"account_mobile"},{"count":"4","industry_display_name":"一般消费分期平台","dim_type":"id_number"},{"count":"1","industry_display_name":"互联网金融门户","dim_type":"id_number"},{"count":"2","industry_display_name":"小额贷款公司","dim_type":"id_number"},{"count":"8","industry_display_name":"P2P网贷","dim_type":"id_number"},{"count":"2","industry_display_name":"一般消费分期平台","dim_type":"device_id"},{"count":"1","industry_display_name":"小额贷款公司","dim_type":"device_id"},{"count":"2","industry_display_name":"P2P网贷","dim_type":"device_id"}],"results_for_dim":[{"count":"15","dim_type":"account_mobile"},{"count":"15","dim_type":"id_number"},{"count":"5","dim_type":"device_id"}],"result":"15","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598566","score":"50"},{"conditions":[{"dim_type":null,"dim_value":null,"hits":[{"count":"6","industry_display_name":"一般消费分期平台"},{"count":"1","industry_display_name":"互联网金融门户"},{"count":"6","industry_display_name":"小额贷款公司"},{"count":"16","industry_display_name":"P2P网贷"}],"type":"association_partner","event_type":null,"hits_for_dim":[{"count":"6","industry_display_name":"一般消费分期平台","dim_type":"account_mobile"},{"count":"1","industry_display_name":"互联网金融门户","dim_type":"account_mobile"},{"count":"6","industry_display_name":"小额贷款公司","dim_type":"account_mobile"},{"count":"16","industry_display_name":"P2P网贷","dim_type":"account_mobile"},{"count":"6","industry_display_name":"一般消费分期平台","dim_type":"id_number"},{"count":"1","industry_display_name":"互联网金融门户","dim_type":"id_number"},{"count":"6","industry_display_name":"小额贷款公司","dim_type":"id_number"},{"count":"16","industry_display_name":"P2P网贷","dim_type":"id_number"},{"count":"2","industry_display_name":"一般消费分期平台","dim_type":"device_id"},{"count":"2","industry_display_name":"小额贷款公司","dim_type":"device_id"},{"count":"5","industry_display_name":"P2P网贷","dim_type":"device_id"}],"results_for_dim":[{"count":"29","dim_type":"account_mobile"},{"count":"9","dim_type":"device_id"},{"count":"29","dim_type":"id_number"}],"result":"29","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598568","score":"35"},{"conditions":[{"dim_type":null,"dim_value":null,"hits":[{"count":"1","industry_display_name":"第三方服务商"},{"count":"1","industry_display_name":"大型消费金融公司"},{"count":"2","industry_display_name":"信用卡中心"},{"count":"24","industry_display_name":"P2P网贷"},{"count":"10","industry_display_name":"一般消费分期平台"},{"count":"1","industry_display_name":"互联网金融门户"},{"count":"10","industry_display_name":"小额贷款公司"}],"type":"association_partner","event_type":null,"hits_for_dim":[{"count":"1","industry_display_name":"第三方服务商","dim_type":"account_mobile"},{"count":"1","industry_display_name":"信用卡中心","dim_type":"account_mobile"},{"count":"24","industry_display_name":"P2P网贷","dim_type":"account_mobile"},{"count":"9","industry_display_name":"一般消费分期平台","dim_type":"account_mobile"},{"count":"1","industry_display_name":"互联网金融门户","dim_type":"account_mobile"},{"count":"10","industry_display_name":"小额贷款公司","dim_type":"account_mobile"},{"count":"1","industry_display_name":"第三方服务商","dim_type":"id_number"},{"count":"1","industry_display_name":"大型消费金融公司","dim_type":"id_number"},{"count":"1","industry_display_name":"信用卡中心","dim_type":"id_number"},{"count":"24","industry_display_name":"P2P网贷","dim_type":"id_number"},{"count":"9","industry_display_name":"一般消费分期平台","dim_type":"id_number"},{"count":"1","industry_display_name":"互联网金融门户","dim_type":"id_number"},{"count":"10","industry_display_name":"小额贷款公司","dim_type":"id_number"},{"count":"2","industry_display_name":"一般消费分期平台","dim_type":"device_id"},{"count":"2","industry_display_name":"小额贷款公司","dim_type":"device_id"},{"count":"5","industry_display_name":"P2P网贷","dim_type":"device_id"}],"results_for_dim":[{"count":"9","dim_type":"device_id"},{"count":"47","dim_type":"id_number"},{"count":"46","dim_type":"account_mobile"}],"result":"49","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598570","score":"30"},{"conditions":[{"dim_type":null,"dim_value":null,"hits":[{"count":"1","industry_display_name":"第三方服务商"},{"count":"1","industry_display_name":"大型消费金融公司"},{"count":"2","industry_display_name":"信用卡中心"},{"count":"27","industry_display_name":"P2P网贷"},{"count":"11","industry_display_name":"一般消费分期平台"},{"count":"1","industry_display_name":"互联网金融门户"},{"count":"10","industry_display_name":"小额贷款公司"}],"type":"cross_partner","event_type":"Loan","hits_for_dim":[{"count":"1","industry_display_name":"第三方服务商","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"2","industry_display_name":"信用卡中心","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"27","industry_display_name":"P2P网贷","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"10","industry_display_name":"一般消费分期平台","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"1","industry_display_name":"互联网金融门户","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"10","industry_display_name":"小额贷款公司","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"1","industry_display_name":"第三方服务商","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"1","industry_display_name":"大型消费金融公司","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"1","industry_display_name":"信用卡中心","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"27","industry_display_name":"P2P网贷","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"10","industry_display_name":"一般消费分期平台","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"1","industry_display_name":"互联网金融门户","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"10","industry_display_name":"小额贷款公司","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"2","industry_display_name":"一般消费分期平台","original_dim_type":"device_id","match_dim_type":"device_id"},{"count":"2","industry_display_name":"小额贷款公司","original_dim_type":"device_id","match_dim_type":"device_id"},{"count":"5","industry_display_name":"P2P网贷","original_dim_type":"device_id","match_dim_type":"device_id"}],"results_for_dim":[{"count":"9","original_dim_type":"device_id","match_dim_type":"device_id"},{"count":"51","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"51","original_dim_type":"account_mobile","match_dim_type":"account_mobile"}],"result":"53","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598572","score":"0"},{"conditions":[{"dim_type":null,"dim_value":null,"hits":[{"count":"1","industry_display_name":"第三方服务商"},{"count":"1","industry_display_name":"大型消费金融公司"},{"count":"2","industry_display_name":"信用卡中心"},{"count":"27","industry_display_name":"P2P网贷"},{"count":"11","industry_display_name":"一般消费分期平台"},{"count":"1","industry_display_name":"互联网金融门户"},{"count":"10","industry_display_name":"小额贷款公司"}],"type":"cross_partner","event_type":"Loan","hits_for_dim":[{"count":"1","industry_display_name":"第三方服务商","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"2","industry_display_name":"信用卡中心","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"27","industry_display_name":"P2P网贷","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"10","industry_display_name":"一般消费分期平台","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"1","industry_display_name":"互联网金融门户","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"10","industry_display_name":"小额贷款公司","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"1","industry_display_name":"第三方服务商","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"1","industry_display_name":"大型消费金融公司","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"1","industry_display_name":"信用卡中心","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"27","industry_display_name":"P2P网贷","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"10","industry_display_name":"一般消费分期平台","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"1","industry_display_name":"互联网金融门户","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"10","industry_display_name":"小额贷款公司","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"2","industry_display_name":"一般消费分期平台","original_dim_type":"device_id","match_dim_type":"device_id"},{"count":"2","industry_display_name":"小额贷款公司","original_dim_type":"device_id","match_dim_type":"device_id"},{"count":"5","industry_display_name":"P2P网贷","original_dim_type":"device_id","match_dim_type":"device_id"}],"results_for_dim":[{"count":"9","original_dim_type":"device_id","match_dim_type":"device_id"},{"count":"51","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"51","original_dim_type":"account_mobile","match_dim_type":"account_mobile"}],"result":"53","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598574","score":"0"},{"conditions":[{"dim_type":null,"dim_value":null,"hits":[{"count":"1","industry_display_name":"第三方服务商"},{"count":"1","industry_display_name":"大型消费金融公司"},{"count":"2","industry_display_name":"信用卡中心"},{"count":"27","industry_display_name":"P2P网贷"},{"count":"11","industry_display_name":"一般消费分期平台"},{"count":"1","industry_display_name":"互联网金融门户"},{"count":"10","industry_display_name":"小额贷款公司"}],"type":"cross_partner","event_type":"Loan","hits_for_dim":[{"count":"1","industry_display_name":"第三方服务商","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"2","industry_display_name":"信用卡中心","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"27","industry_display_name":"P2P网贷","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"10","industry_display_name":"一般消费分期平台","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"1","industry_display_name":"互联网金融门户","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"10","industry_display_name":"小额贷款公司","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"1","industry_display_name":"第三方服务商","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"1","industry_display_name":"大型消费金融公司","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"1","industry_display_name":"信用卡中心","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"27","industry_display_name":"P2P网贷","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"10","industry_display_name":"一般消费分期平台","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"1","industry_display_name":"互联网金融门户","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"10","industry_display_name":"小额贷款公司","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"2","industry_display_name":"一般消费分期平台","original_dim_type":"device_id","match_dim_type":"device_id"},{"count":"2","industry_display_name":"小额贷款公司","original_dim_type":"device_id","match_dim_type":"device_id"},{"count":"5","industry_display_name":"P2P网贷","original_dim_type":"device_id","match_dim_type":"device_id"}],"results_for_dim":[{"count":"9","original_dim_type":"device_id","match_dim_type":"device_id"},{"count":"51","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"51","original_dim_type":"account_mobile","match_dim_type":"account_mobile"}],"result":"53","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598576","score":"0"},{"conditions":[{"dim_type":null,"dim_value":null,"hits":[{"count":"1","industry_display_name":"第三方服务商"},{"count":"1","industry_display_name":"大型消费金融公司"},{"count":"2","industry_display_name":"信用卡中心"},{"count":"27","industry_display_name":"P2P网贷"},{"count":"11","industry_display_name":"一般消费分期平台"},{"count":"1","industry_display_name":"互联网金融门户"},{"count":"10","industry_display_name":"小额贷款公司"}],"type":"cross_partner","event_type":"Loan","hits_for_dim":[{"count":"1","industry_display_name":"第三方服务商","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"2","industry_display_name":"信用卡中心","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"27","industry_display_name":"P2P网贷","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"10","industry_display_name":"一般消费分期平台","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"1","industry_display_name":"互联网金融门户","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"10","industry_display_name":"小额贷款公司","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"1","industry_display_name":"第三方服务商","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"1","industry_display_name":"大型消费金融公司","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"1","industry_display_name":"信用卡中心","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"27","industry_display_name":"P2P网贷","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"10","industry_display_name":"一般消费分期平台","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"1","industry_display_name":"互联网金融门户","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"10","industry_display_name":"小额贷款公司","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"2","industry_display_name":"一般消费分期平台","original_dim_type":"device_id","match_dim_type":"device_id"},{"count":"2","industry_display_name":"小额贷款公司","original_dim_type":"device_id","match_dim_type":"device_id"},{"count":"5","industry_display_name":"P2P网贷","original_dim_type":"device_id","match_dim_type":"device_id"}],"results_for_dim":[{"count":"9","original_dim_type":"device_id","match_dim_type":"device_id"},{"count":"51","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"51","original_dim_type":"account_mobile","match_dim_type":"account_mobile"}],"result":"53","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598578","score":"0"},{"conditions":[{"dim_type":null,"dim_value":null,"hits":[{"count":"1","industry_display_name":"第三方服务商"},{"count":"1","industry_display_name":"大型消费金融公司"},{"count":"2","industry_display_name":"信用卡中心"},{"count":"27","industry_display_name":"P2P网贷"},{"count":"11","industry_display_name":"一般消费分期平台"},{"count":"1","industry_display_name":"互联网金融门户"},{"count":"10","industry_display_name":"小额贷款公司"}],"type":"cross_partner","event_type":"Loan","hits_for_dim":[{"count":"1","industry_display_name":"第三方服务商","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"2","industry_display_name":"信用卡中心","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"27","industry_display_name":"P2P网贷","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"10","industry_display_name":"一般消费分期平台","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"1","industry_display_name":"互联网金融门户","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"10","industry_display_name":"小额贷款公司","original_dim_type":"account_mobile","match_dim_type":"account_mobile"},{"count":"1","industry_display_name":"第三方服务商","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"1","industry_display_name":"大型消费金融公司","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"1","industry_display_name":"信用卡中心","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"27","industry_display_name":"P2P网贷","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"10","industry_display_name":"一般消费分期平台","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"1","industry_display_name":"互联网金融门户","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"10","industry_display_name":"小额贷款公司","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"2","industry_display_name":"一般消费分期平台","original_dim_type":"device_id","match_dim_type":"device_id"},{"count":"2","industry_display_name":"小额贷款公司","original_dim_type":"device_id","match_dim_type":"device_id"},{"count":"5","industry_display_name":"P2P网贷","original_dim_type":"device_id","match_dim_type":"device_id"}],"results_for_dim":[{"count":"9","original_dim_type":"device_id","match_dim_type":"device_id"},{"count":"51","original_dim_type":"id_number","match_dim_type":"id_number"},{"count":"51","original_dim_type":"account_mobile","match_dim_type":"account_mobile"}],"result":"53","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598580","score":"6"},{"conditions":[{"dim_type":"account_mobile","dim_value":"15234193973","hits":null,"type":"frequency_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"14","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"device_id","dim_value":"9d0ef0d8-1de6-4509-87a50-3f1eb1c03fe","hits":null,"type":"frequency_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"4","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"frequency_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"14","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598616","score":"0"},{"conditions":[{"dim_type":"device_id","dim_value":"9d0ef0d8-1de6-4509-87a50-3f1eb1c03fe","hits":null,"type":"frequency_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"11","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"account_mobile","dim_value":"15234193973","hits":null,"type":"frequency_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"39","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"frequency_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"39","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598618","score":"0"},{"conditions":[{"dim_type":"trueip_address","dim_value":"118.77.167.75","hits":null,"type":"frequency_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598620","score":"1"},{"conditions":[{"dim_type":"trueip_address","dim_value":"118.77.167.75","hits":null,"type":"frequency_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"3598622","score":"1"},{"conditions":[{"dim_type":"trueip_address","dim_value":"118.77.167.75","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":["15234193973"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"account_mobile","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"6635871","score":"0"},{"conditions":[{"dim_type":"trueip_address","dim_value":"118.77.167.75","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":["15234193973"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"account_mobile","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"6635881","score":"0"},{"conditions":[{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"2","list":["15234193973","171※※※※3906"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"account_mobile","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"2","list":["山西省太※※※※※※※※※※※※※※※楼2单元","西铭九※※※※※※※2单元"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"home_address","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"2","list":["148※※※※988@qq.com","152※※※※※973@qq.com"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"account_email","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"8235857","score":"0"},{"conditions":[{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"cross_velocity_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"0","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":"contact3_id_number","address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"cross_velocity_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"0","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":"contact5_id_number","address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"cross_velocity_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"0","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":"contact1_id_number","address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"cross_velocity_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"0","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":"contact4_id_number","address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"cross_velocity_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"0","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":"contact2_id_number","address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"9379813","score":"0"},{"conditions":[{"dim_type":"account_mobile","dim_value":"15234193973","hits":null,"type":"cross_velocity_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"0","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":"contact5_mobile","address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"account_mobile","dim_value":"15234193973","hits":null,"type":"cross_velocity_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"0","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":"contact3_mobile","address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"account_mobile","dim_value":"15234193973","hits":null,"type":"cross_velocity_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"0","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":"contact2_mobile","address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"account_mobile","dim_value":"15234193973","hits":null,"type":"cross_velocity_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"0","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":"contact4_mobile","address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"account_mobile","dim_value":"15234193973","hits":null,"type":"cross_velocity_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"0","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":"contact1_mobile","address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"9379823","score":"0"},{"conditions":[{"dim_type":"card_number","dim_value":"6212260502003393175","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":["142223199604136144"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"id_number","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"9379803","score":"0"},{"conditions":[{"dim_type":"device_id","dim_value":"9d0ef0d8-1de6-4509-87a50-3f1eb1c03fe","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"0","list":[],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"ip_address_city","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"9379833","score":"0"},{"conditions":[{"dim_type":"device_id","dim_value":"9d0ef0d8-1de6-4509-87a50-3f1eb1c03fe","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":["1422※※※※※※※※※※6144"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"id_number","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"device_id","dim_value":"9d0ef0d8-1de6-4509-87a50-3f1eb1c03fe","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":["152※※※※3973"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"account_mobile","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"9379843","score":"0"},{"conditions":[{"dim_type":"device_id","dim_value":"9d0ef0d8-1de6-4509-87a50-3f1eb1c03fe","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":["1422※※※※※※※※※※6144"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"id_number","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"device_id","dim_value":"9d0ef0d8-1de6-4509-87a50-3f1eb1c03fe","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":["152※※※※3973"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"account_mobile","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"9379853","score":"0"},{"conditions":[{"dim_type":"device_id","dim_value":"9d0ef0d8-1de6-4509-87a50-3f1eb1c03fe","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"0","list":[],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"id_number","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"device_id","dim_value":"9d0ef0d8-1de6-4509-87a50-3f1eb1c03fe","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"0","list":[],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"id_number","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"9379903","score":"0"},{"conditions":[{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":["9d0ef0d8-1de6-4509-87a50-3f1eb1c03fe"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"device_id","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"9562203","score":"0"},{"conditions":[{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":["9d0ef0d8-1de6-4509-87a50-3f1eb1c03fe"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"device_id","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"9562213","score":"0"},{"conditions":[{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"frequency_distinct","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"6","list":["9d0ef0d8-1de6-4509-87a50-3f1eb1c03fe","3b5c※※※※※※※※※※※※※※※※※※※※※※※※※※※※b74b","4a23※※※※※※※※※※※※※※※※※※※※※※※※※※※※b11a","9d46※※※※※※※※※※※※※※※※※※※※※※※※4473","1f99※※※※※※※※※※※※※※※※※※※※※※※※2d77","2bb0※※※※※※※※※※※※※※※※※※※※※※※※5372"],"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":"device_id","match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"9562233","score":"0"},{"conditions":[{"dim_type":"account_mobile","dim_value":"15234193973","hits":null,"type":"frequency_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"frequency_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"device_id","dim_value":"9d0ef0d8-1de6-4509-87a50-3f1eb1c03fe","hits":null,"type":"frequency_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"9562243","score":"0"},{"conditions":[{"dim_type":"device_id","dim_value":"9d0ef0d8-1de6-4509-87a50-3f1eb1c03fe","hits":null,"type":"frequency_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"id_number","dim_value":"142223199604136144","hits":null,"type":"frequency_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null},{"dim_type":"account_mobile","dim_value":"15234193973","hits":null,"type":"frequency_one_dim","event_type":null,"hits_for_dim":null,"results_for_dim":null,"result":"1","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"9562253","score":"0"},{"conditions":[{"dim_type":null,"dim_value":null,"hits":[{"count":"4","industry_display_name":"一般消费分期平台"},{"count":"1","industry_display_name":"互联网金融门户"},{"count":"2","industry_display_name":"小额贷款公司"},{"count":"8","industry_display_name":"P2P网贷"}],"type":"association_partner","event_type":null,"hits_for_dim":[{"count":"4","industry_display_name":"一般消费分期平台","dim_type":"account_mobile"},{"count":"1","industry_display_name":"互联网金融门户","dim_type":"account_mobile"},{"count":"2","industry_display_name":"小额贷款公司","dim_type":"account_mobile"},{"count":"8","industry_display_name":"P2P网贷","dim_type":"account_mobile"},{"count":"4","industry_display_name":"一般消费分期平台","dim_type":"id_number"},{"count":"1","industry_display_name":"互联网金融门户","dim_type":"id_number"},{"count":"2","industry_display_name":"小额贷款公司","dim_type":"id_number"},{"count":"8","industry_display_name":"P2P网贷","dim_type":"id_number"},{"count":"2","industry_display_name":"一般消费分期平台","dim_type":"device_id"},{"count":"1","industry_display_name":"小额贷款公司","dim_type":"device_id"},{"count":"2","industry_display_name":"P2P网贷","dim_type":"device_id"}],"results_for_dim":[{"count":"15","dim_type":"account_mobile"},{"count":"15","dim_type":"id_number"},{"count":"5","dim_type":"device_id"}],"result":"15","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"9562303","score":"0"},{"conditions":[{"dim_type":null,"dim_value":null,"hits":[{"count":"6","industry_display_name":"一般消费分期平台"},{"count":"1","industry_display_name":"互联网金融门户"},{"count":"6","industry_display_name":"小额贷款公司"},{"count":"16","industry_display_name":"P2P网贷"}],"type":"association_partner","event_type":null,"hits_for_dim":[{"count":"6","industry_display_name":"一般消费分期平台","dim_type":"account_mobile"},{"count":"1","industry_display_name":"互联网金融门户","dim_type":"account_mobile"},{"count":"6","industry_display_name":"小额贷款公司","dim_type":"account_mobile"},{"count":"16","industry_display_name":"P2P网贷","dim_type":"account_mobile"},{"count":"6","industry_display_name":"一般消费分期平台","dim_type":"id_number"},{"count":"1","industry_display_name":"互联网金融门户","dim_type":"id_number"},{"count":"6","industry_display_name":"小额贷款公司","dim_type":"id_number"},{"count":"16","industry_display_name":"P2P网贷","dim_type":"id_number"},{"count":"2","industry_display_name":"一般消费分期平台","dim_type":"device_id"},{"count":"2","industry_display_name":"小额贷款公司","dim_type":"device_id"},{"count":"5","industry_display_name":"P2P网贷","dim_type":"device_id"}],"results_for_dim":[{"count":"29","dim_type":"account_mobile"},{"count":"9","dim_type":"device_id"},{"count":"29","dim_type":"id_number"}],"result":"29","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"9562313","score":"0"},{"conditions":[{"dim_type":null,"dim_value":null,"hits":[{"count":"1","industry_display_name":"第三方服务商"},{"count":"1","industry_display_name":"大型消费金融公司"},{"count":"2","industry_display_name":"信用卡中心"},{"count":"24","industry_display_name":"P2P网贷"},{"count":"10","industry_display_name":"一般消费分期平台"},{"count":"1","industry_display_name":"互联网金融门户"},{"count":"10","industry_display_name":"小额贷款公司"}],"type":"association_partner","event_type":null,"hits_for_dim":[{"count":"1","industry_display_name":"第三方服务商","dim_type":"account_mobile"},{"count":"1","industry_display_name":"信用卡中心","dim_type":"account_mobile"},{"count":"24","industry_display_name":"P2P网贷","dim_type":"account_mobile"},{"count":"9","industry_display_name":"一般消费分期平台","dim_type":"account_mobile"},{"count":"1","industry_display_name":"互联网金融门户","dim_type":"account_mobile"},{"count":"10","industry_display_name":"小额贷款公司","dim_type":"account_mobile"},{"count":"1","industry_display_name":"第三方服务商","dim_type":"id_number"},{"count":"1","industry_display_name":"大型消费金融公司","dim_type":"id_number"},{"count":"1","industry_display_name":"信用卡中心","dim_type":"id_number"},{"count":"24","industry_display_name":"P2P网贷","dim_type":"id_number"},{"count":"9","industry_display_name":"一般消费分期平台","dim_type":"id_number"},{"count":"1","industry_display_name":"互联网金融门户","dim_type":"id_number"},{"count":"10","industry_display_name":"小额贷款公司","dim_type":"id_number"},{"count":"2","industry_display_name":"一般消费分期平台","dim_type":"device_id"},{"count":"2","industry_display_name":"小额贷款公司","dim_type":"device_id"},{"count":"5","industry_display_name":"P2P网贷","dim_type":"device_id"}],"results_for_dim":[{"count":"9","dim_type":"device_id"},{"count":"47","dim_type":"id_number"},{"count":"46","dim_type":"account_mobile"}],"result":"49","list":null,"calc_dim_type":null,"calc_type":null,"calc_dim_type_value":null,"sub_dim_type":null,"match_dim_type":null,"address_a":null,"address_a_value":null,"address_b":null,"address_b_value":null,"proxy_ip_type":null,"unit":null,"hook_inline":null,"hook_i_m_p":null,"abnormal_tags":null}],"rule_id":"9562323","score":"0"}]}
      """.stripMargin
    val sauronOgnlJson = wrapJson("tdFraudDetail", query_result)
    val o = JSON.parseObject(sauronOgnlJson)
    println(sauronOgnlJson)
    if (o.toString.contains("rule_id==0000431")) {
      println("包含rule_id..")
      val near3MonthApplyHit = Ognl.getValue(InkConfig.NEAR3MONTHPAALYHIT, o).toString
      println(near3MonthApplyHit)
    }

  }*/
}
